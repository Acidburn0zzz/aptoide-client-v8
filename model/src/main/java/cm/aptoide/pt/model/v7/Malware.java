/*
 * Copyright (c) 2016.
 * Modified by Neurophobic Animal on 07/06/2016.
 */

package cm.aptoide.pt.model.v7;

import java.util.List;
import lombok.Data;

/**
 * List of various malware reasons http://ws2.aptoide .com/api/7/getApp/apk_md5sum/7de07d96488277d8d76eafa2ef66f5a8
 * <p>
 * <p>
 * RANK2: http://ws2.aptoide.com/api/7/getApp/apk_md5sum/7de07d96488277d8d76eafa2ef66f5a8
 * http://ws2.aptoide.com/api/7/getApp/apk_md5sum/06c9eb56b787b6d3b606d68473a38f47
 * <p>
 * RANK3: http://ws2.aptoide.com/api/7/getApp/apk_md5sum/18f0d5bdb9df1e0e27604890113c3331
 * http://ws2.aptoide.com/api/7/getApp/apk_md5sum/74cbfde9dc6da43d3d14f4df9cdb9f2f
 * <p>
 * Rank can be: TRUSTED, WARNING, UNKNOWN, CRITICAL
 */
@Data public class Malware {

  public static final String PASSED = "passed";
  public static final String WARN = "warn";
  public static final String GOOGLE_PLAY = "Google Play";

  private Rank rank;
  private Reason reason;
  private String added;
  private String modified;

  public enum Rank {
    TRUSTED, WARNING, UNKNOWN, CRITICAL
  }

  @Data public static class Reason {

    private Reason.SignatureValidated signatureValidated;
    private Reason.ThirdPartyValidated thirdpartyValidated;
    private Reason.Manual manual;
    private Reason.Scanned scanned;

    public enum Status {
      passed, failed, blacklisted, warn
    }

    @Data public static class SignatureValidated {

      private String date;
      private Reason.Status status;
      private String signatureFrom;
    }

    @Data public static class ThirdPartyValidated {

      private String date;
      private String store;
    }

    @Data public static class Manual {

      private String date;
      private Reason.Status status;
      private List<String> av;
    }

    @Data public static class Scanned {

      private Reason.Status status;
      private String date;
      private List<Reason.Scanned.AvInfo> avInfo;

      @Data public static class AvInfo {

        private List<Reason.Scanned.AvInfo.Infection> infections;
        private String name;

        @Data public static class Infection {

          private String name;
          private String description;
        }
      }
    }
  }
}
